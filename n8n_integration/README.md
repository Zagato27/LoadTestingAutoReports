# ğŸš€ n8n Integration - Ğ˜Ğ·Ğ¾Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚

**ĞŸĞ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ°Ğ²Ñ‚Ğ¾Ğ½Ğ¾Ğ¼Ğ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ¾Ğ² Ğ¿Ğ¾ Ğ½Ğ°Ğ³Ñ€ÑƒĞ·Ğ¾Ñ‡Ğ½Ğ¾Ğ¼Ñƒ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ½Ğ° Ğ±Ğ°Ğ·Ğµ n8n + AI**

## âœ¨ ĞÑĞ¾Ğ±ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸

âœ… **ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ¸Ğ·Ğ¾Ğ»ÑÑ†Ğ¸Ñ** - Ğ²ÑĞµ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ğ¸  
âœ… **Ğ£Ğ¿Ñ€Ğ¾Ñ‰ĞµĞ½Ğ½Ñ‹Ğ¹ workflow** - Ğ±ĞµĞ· Loki (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Grafana + AI)  
âœ… **AI-Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·** - JVM, Database, Kafka, Microservices  
âœ… **Docker ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ** - docker-compose Ğ´Ğ»Ñ Ğ²ÑĞµĞ³Ğ¾ ÑÑ‚ĞµĞºĞ°  
âœ… **ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ** - ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ñ‹ Ñ€Ğ°Ğ·Ğ²ĞµÑ€Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¸ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ  

---

## ğŸ“ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°

```
n8n_integration/                    # â† Ğ’Ğ¡Ğ Ğ—Ğ”Ğ•Ğ¡Ğ¬ (Ğ¸Ğ·Ğ¾Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾)
â”œâ”€â”€ ğŸŒŸ Workflow
â”‚   â””â”€â”€ n8n_workflow_simple.json        # Ğ£Ğ¿Ñ€Ğ¾Ñ‰ĞµĞ½Ğ½Ñ‹Ğ¹ workflow (Grafana + AI)
â”‚
â”œâ”€â”€ ğŸ’» AI-ÑĞµÑ€Ğ²Ğ¸Ñ
â”‚   â”œâ”€â”€ ai_service_for_n8n.py           # Flask REST API
â”‚   â”œâ”€â”€ AI/                             # AI-Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ (ĞºĞ¾Ğ¿Ğ¸Ñ)
â”‚   â”œâ”€â”€ confluence_manager/             # Confluence ÑƒÑ‚Ğ¸Ğ»Ğ¸Ñ‚Ñ‹ (ĞºĞ¾Ğ¿Ğ¸Ñ)
â”‚   â””â”€â”€ config.py                       # Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸
â”‚
â”œâ”€â”€ ğŸ³ Docker
â”‚   â”œâ”€â”€ docker-compose.yml              # Docker Compose
â”‚   â”œâ”€â”€ Dockerfile                      # AI-ÑĞµÑ€Ğ²Ğ¸Ñ Ğ¾Ğ±Ñ€Ğ°Ğ·
â”‚   â”œâ”€â”€ env.example.txt                 # Ğ¨Ğ°Ğ±Ğ»Ğ¾Ğ½ .env
â”‚   â””â”€â”€ requirements.txt                # Python Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
â”‚
â”œâ”€â”€ ğŸ”§ Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚Ñ‹
â”‚   â”œâ”€â”€ deploy_ai_service.sh            # Ğ Ğ°Ğ·Ğ²ĞµÑ€Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğµ
â”‚   â””â”€â”€ test_ai_integration.sh          # Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
â”‚
â””â”€â”€ ğŸ“š Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ
    â””â”€â”€ README.md (ÑÑ‚Ğ¾Ñ‚ Ñ„Ğ°Ğ¹Ğ»)
```

---

## ğŸš€ Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚

### 1. ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° (1 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ğ°)

```bash
# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ .env
cp env.example.txt .env

# ĞÑ‚Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ .env
nano .env
```

**ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹Ñ‚Ğµ:**
```bash
POSTGRES_PASSWORD=your_secure_password
PROMETHEUS_URL=http://your-prometheus:9090
```

### 2. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° AI (1 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ğ°)

ĞÑ‚Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ `AI/config.py`:

```python
CONFIG = {
    "prometheus": {
        "url": "http://prometheus:9090"
    },
    "llm": {
        "provider": "gigachat",
        "gigachat": {
            "model": "GigaChat-Pro",
            "base_url": "https://gigachat.devices.sberbank.ru/api/v1",
            "cert_file": "/app/certs/client.crt",
            "key_file": "/app/certs/client.key",
            # ...
        }
    },
    # ... Ğ¾ÑÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ
}
```

### 3. Ğ—Ğ°Ğ¿ÑƒÑĞº (2 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹)

```bash
# Ğ¡Ğ´ĞµĞ»Ğ°Ğ¹Ñ‚Ğµ ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ñ‹ Ğ¸ÑĞ¿Ğ¾Ğ»Ğ½ÑĞµĞ¼Ñ‹Ğ¼Ğ¸
chmod +x deploy_ai_service.sh test_ai_integration.sh

# ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ñ€Ğ°Ğ·Ğ²ĞµÑ€Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğµ
./deploy_ai_service.sh
```

### 4. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° n8n (2 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹)

1. ĞÑ‚ĞºÑ€Ğ¾Ğ¹Ñ‚Ğµ: **http://localhost:5678**

2. **Import workflow:**
   - Settings â†’ Import from File
   - Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ: `n8n_workflow_simple.json`

3. **ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹Ñ‚Ğµ Credentials:**
   
   **Confluence:**
   ```
   Ğ¢Ğ¸Ğ¿: HTTP Basic Auth
   ID: confluence-creds
   Username: Ğ²Ğ°Ñˆ_Ğ»Ğ¾Ğ³Ğ¸Ğ½
   Password: Ğ²Ğ°Ñˆ_Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ
   ```
   
   **Grafana:**
   ```
   Ğ¢Ğ¸Ğ¿: HTTP Basic Auth
   ID: grafana-creds
   Username: grafana_login
   Password: grafana_password
   ```

4. **ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğµ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº** Ğ² ÑƒĞ·Ğ»Ğµ "Get Service Config"

5. **ĞĞºÑ‚Ğ¸Ğ²Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ workflow** (ĞºĞ½Ğ¾Ğ¿ĞºĞ° "Active")

### 5. Ğ¢ĞµÑÑ‚

```bash
# Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ°
./test_ai_integration.sh quick

# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ°
curl -X POST http://localhost:5678/webhook/load-testing/report/create \
  -H "Content-Type: application/json" \
  -d '{
    "start": "2025-02-21T11:30",
    "end": "2025-02-21T14:10",
    "service": "NSI"
  }'
```

---

## ğŸ¯ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ĞšĞ»Ğ¸ĞµĞ½Ñ‚  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   n8n Workflow      â”‚
â”‚                     â”‚
â”‚  1. Copy page       â”‚
â”‚  2. Parallel:       â”‚
â”‚     â”œâ”€ Grafana â”€â”€â”€â”€â”â”‚
â”‚     â””â”€ AI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚                    â”‚â”‚
â”‚  3. Merge      â—„â”€â”€â”€â”˜â”‚
â”‚  4. Update page     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AI Microservice    â”‚
â”‚  (Flask REST API)   â”‚
â”‚                     â”‚
â”‚  /health            â”‚
â”‚  /analyze           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ./AI/main.py     â”‚
â”‚                     â”‚
â”‚  - Prometheus       â”‚
â”‚  - GigaChat         â”‚
â”‚  - Analysis         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ğ§Ñ‚Ğ¾ ÑƒĞ±Ñ€Ğ°Ğ½Ğ¾ Ğ¿Ğ¾ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ñ Ğ¾Ñ€Ğ¸Ğ³Ğ¸Ğ½Ğ°Ğ»Ğ¾Ğ¼:**
- âŒ Loki Ğ»Ğ¾Ğ³Ğ¸
- âŒ Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¾Ñ‚ Ñ€Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ñ… Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ğ¹

**Ğ§Ñ‚Ğ¾ Ğ¾ÑÑ‚Ğ°Ğ»Ğ¾ÑÑŒ:**
- âœ… Grafana Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸
- âœ… AI-Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· (4 Ğ´Ğ¾Ğ¼ĞµĞ½Ğ°)
- âœ… Confluence Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ
- âœ… ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ¸Ğ·Ğ¾Ğ»ÑÑ†Ğ¸Ñ

---

## ğŸ“Š AI-Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·

AI Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµÑ‚:

### 1. JVM Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸
- Heap/Non-Heap Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ
- CPU Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²
- GC Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ

### 2. Database Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸
- ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ
- Ğ’Ñ€ĞµĞ¼ĞµĞ½Ğ° Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
- Ğ‘Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ¸

### 3. Kafka Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸
- Consumer lag
- Fetch rate
- Throughput

### 4. Microservices Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸
- RPS
- Response times
- Error rates

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:** Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ¾Ñ‚Ñ‡ĞµÑ‚ Ñ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ°Ğ¼Ğ¸ Ğ¸ Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸ÑĞ¼Ğ¸

---

## âš™ï¸ ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ

### ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸

ĞÑ‚ĞºÑ€Ğ¾Ğ¹Ñ‚Ğµ workflow Ğ² n8n â†’ ÑƒĞ·ĞµĞ» **"Get Service Config"**

```javascript
const METRICS_CONFIG = {
  "NSI": {
    "confluence_url": "https://confluence.company.com",
    "page_sample_id": "682908703",
    "page_parent_id": "882999920",
    "grafana_base_url": "http://grafana:3000",
    "metrics": [
      {
        "name": "RPS",
        "grafana_url": "/render/d-solo/..."
      },
      // ... Ğ´Ğ¾Ğ±Ğ°Ğ²ÑŒÑ‚Ğµ Ğ²ÑĞµ Ğ²Ğ°ÑˆĞ¸ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸
    ]
  }
};
```

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ğµ:** Ğ¡ĞµĞºÑ†Ğ¸Ñ `logs` ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ° (Loki Ğ½Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ)

---

## ğŸ”§ Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ

### Ğ Ğ°Ğ·Ğ²ĞµÑ€Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğµ

```bash
./deploy_ai_service.sh          # ĞŸĞ¾Ğ»Ğ½Ğ¾Ğµ Ñ€Ğ°Ğ·Ğ²ĞµÑ€Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğµ
./deploy_ai_service.sh check    # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹
./deploy_ai_service.sh build    # Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²
./deploy_ai_service.sh start    # Ğ—Ğ°Ğ¿ÑƒÑĞº ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²
./deploy_ai_service.sh stop     # ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°
./deploy_ai_service.sh logs     # Ğ›Ğ¾Ğ³Ğ¸ AI-ÑĞµÑ€Ğ²Ğ¸ÑĞ°
```

### Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

```bash
./test_ai_integration.sh        # ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ½Ğ°Ğ±Ğ¾Ñ€ Ñ‚ĞµÑÑ‚Ğ¾Ğ²
./test_ai_integration.sh quick  # Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ°
./test_ai_integration.sh ai-only # Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ AI-ÑĞµÑ€Ğ²Ğ¸Ñ
```

### Docker Compose

```bash
# Ğ—Ğ°Ğ¿ÑƒÑĞº
docker-compose up -d

# Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ
docker-compose ps

# Ğ›Ğ¾Ğ³Ğ¸
docker-compose logs -f ai-analyzer
docker-compose logs -f n8n

# ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°
docker-compose down

# ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ°
docker-compose down -v
```

---

## ğŸ› Troubleshooting

### AI-ÑĞµÑ€Ğ²Ğ¸Ñ Ğ½Ğµ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ÑÑ

```bash
# Ğ›Ğ¾Ğ³Ğ¸
docker-compose logs ai-analyzer

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸
curl http://localhost:5001/config/check | jq .

# ĞŸĞµÑ€ĞµÑĞ±Ğ¾Ñ€ĞºĞ°
docker-compose build ai-analyzer
docker-compose up -d ai-analyzer
```

### n8n Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½

```bash
# Ğ›Ğ¾Ğ³Ğ¸
docker-compose logs n8n

# ĞŸĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞº
docker-compose restart n8n
```

### AI Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ "insufficient_data"

ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°: ĞĞµÑ‚ Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº Ğ² Prometheus Ğ·Ğ° ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
```bash
# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Prometheus
curl http://prometheus:9090/api/v1/query?query=up

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº Ğ·Ğ° Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´
curl "http://prometheus:9090/api/v1/query_range?\
query=jvm_memory_used_bytes&\
start=1708513800&\
end=1708523400&\
step=60" | jq .
```

---

## ğŸ“ API

### Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ°

```bash
POST http://localhost:5678/webhook/load-testing/report/create

Body:
{
  "start": "2025-02-21T11:30",
  "end": "2025-02-21T14:10",
  "service": "NSI"
}
```

**Ğ£ÑĞ¿ĞµÑˆĞ½Ñ‹Ğ¹ Ğ¾Ñ‚Ğ²ĞµÑ‚:**
```json
{
  "status": "success",
  "message": "Report created successfully",
  "page_id": "123456789",
  "page_url": "https://confluence.../viewpage.action?pageId=123456789",
  "service": "NSI",
  "start": 1708513800000,
  "end": 1708523400000
}
```

### AI-ÑĞµÑ€Ğ²Ğ¸Ñ

```bash
# Healthcheck
GET http://localhost:5001/health

# ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ
GET http://localhost:5001/config/check

# ĞĞ½Ğ°Ğ»Ğ¸Ğ·
POST http://localhost:5001/analyze
Body: {"start": 1708513800000, "end": 1708523400000}
```

---

## âœ… Ğ§Ñ‚Ğ¾ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¾

- âœ… n8n Workflow (ÑƒĞ¿Ñ€Ğ¾Ñ‰ĞµĞ½Ğ½Ñ‹Ğ¹)
- âœ… AI-Ğ¼Ğ¸ĞºÑ€Ğ¾ÑĞµÑ€Ğ²Ğ¸Ñ (Ğ¸Ğ·Ğ¾Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹)
- âœ… Grafana Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ
- âœ… AI-Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· (4 Ğ´Ğ¾Ğ¼ĞµĞ½Ğ°)
- âœ… Docker ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
- âœ… Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚Ñ‹ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸
- âœ… ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ¸Ğ·Ğ¾Ğ»ÑÑ†Ğ¸Ñ

## âŒ Ğ§Ñ‚Ğ¾ ÑƒĞ±Ñ€Ğ°Ğ½Ğ¾

- âŒ Loki Ğ»Ğ¾Ğ³Ğ¸
- âŒ Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¾Ñ‚ Ñ€Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ñ… Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ğ¹
- âŒ Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ñ‹Ğµ workflow Ñ Ğ¼Ğ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²Ğ¾Ğ¼ ÑƒĞ·Ğ»Ğ¾Ğ²

---

## ğŸ‰ Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾ Ğº Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ!

Ğ’ÑĞµ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¸Ğ·Ğ¾Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹, Ğ¿Ñ€Ğ¾ĞµĞºÑ‚ Ğ¿Ğ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ°Ğ²Ñ‚Ğ¾Ğ½Ğ¾Ğ¼Ğ½Ñ‹Ğ¹.

**Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ ÑˆĞ°Ğ³Ğ¸:**
1. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹Ñ‚Ğµ `.env`
2. ĞÑ‚Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ `AI/config.py`
3. Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚Ğµ `./deploy_ai_service.sh`
4. Ğ˜Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ workflow Ğ² n8n
5. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ Ğ¾Ñ‚Ñ‡ĞµÑ‚!

Ğ£Ğ´Ğ°Ñ‡Ğ¸! ğŸš€
